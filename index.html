<!DOCTYPE HTML>
<html>
  <head>
    <title>Title</title>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <link rel="stylesheet" href="styles.css">
  </head>
  <body>
    <canvas id="canvas" width="320px" height="320px"></canvas>
    <script type="module">
      function getColorizedImage(src, color) {
        const canvas = document.createElement('canvas');
        canvas.width = src.width;
        canvas.height = src.height;
        const ctx = canvas.getContext('2d');
        
        ctx.drawImage(src, 0, 0);
        
        // Apply color
        ctx.globalCompositeOperation = 'multiply';
        ctx.fillStyle = color;
        ctx.fillRect(0, 0, src.width, src.height);

        // Restore transparency
        ctx.globalCompositeOperation = 'destination-atop';
        ctx.drawImage(src, 0, 0);

        return canvas;
      }

      const canvas = document.getElementById('canvas');
      const ctx = canvas.getContext('2d');

      const image = new Image();
      image.onload = function() {
        ctx.clearRect(0, 0, ctx.width, ctx.height);

        const colorized = getColorizedImage(this, '#aaff33');

        ctx.drawImage(colorized, 0, 0);
      }
      image.src = './images/terrain/grass.png';
    </script>
  </body>
</html>
