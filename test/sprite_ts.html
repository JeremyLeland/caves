<link rel="stylesheet" href="../styles.css">
<div id="ui"></div>
    
<script type="module">
  import { Sprite, Action, Direction } from '../build/Sprite.js';
  import * as Actor from '../build/Actor.js';
  import { GameCanvas, Keyboard, Mouse } from '../build/GameCanvas.js';
  
  const imagePaths = [
    'body', 'chest', 'pants', 'hair', 'hat',  'belt', 'shoes', 'dagger'
  ].map( e => `../images/sprites/humanoid/male/${e}.png` );
  const images = await Sprite.loadImages( imagePaths );

  const sprite = new Sprite( images, Actor.HumanoidAnimationInfos );

  const ui = document.getElementById( 'ui' );
  [ Action.Idle, Action.Walk, Action.Attack, Action.Die ].forEach( action => {
    const button = document.createElement( 'button' );
    button.innerText = Action[ action ];
    button.onclick = () => sprite.startAction( action );
    ui.appendChild( button );
  } );

  const mouse = new Mouse();
  const gameCanvas = new GameCanvas( 90, 90 );
  document.body.appendChild( gameCanvas.getCanvas() );

  let angle = 0;
  gameCanvas.update = ( dt ) => {
    angle = Math.atan2( mouse.y - 64, mouse.x - 32 );
    sprite.update( dt );
  }
  gameCanvas.draw = ( ctx ) => {
    ctx.clearRect( 0, 0, 90, 90 );
    sprite.draw( ctx, 32, 64, angle );
  }
  
</script>
