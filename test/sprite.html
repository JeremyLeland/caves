<link rel="stylesheet" href="../styles.css">
<canvas id="canvas" width="90" height="90"></canvas>
<div id="ui">
  Action: <select id="actions"></select>
</div>
    
<script type="module">
  import { Images } from '../src/Images.js';
  import { Action, Direction, Actor } from '../src/Actor.js';
  import { GameCanvas, Keyboard, Mouse } from '../src/GameCanvas.js';
  
  const imagePaths = [
    'body', 'chest', 'pants', 'hair', 'hat',  'belt', 'shoes', 'dagger'
  ].map(e => `../images/sprites/humanoid/male/${e}.png`);
  const images = await Images.loadImages(imagePaths);

  const actor = new Actor(images);
  actor.spawnAtPoint(32, 64);

  const actionSelect = document.getElementById('actions');

  actionSelect.onchange = () => actor.action = Action[actionSelect.value];

  fillSelectFromArray(actionSelect, Object.keys(Action));

  actionSelect.onchange();

  const ctx = document.getElementById('canvas').getContext('2d');

  const mouse = new Mouse();
  const gameCanvas = new GameCanvas(document.getElementById('canvas'), {fullscreen: false});

  gameCanvas.update = (dt) => {
    actor.aimTowardPoint(mouse.x, mouse.y);
    actor.updateFrame(dt);
  }
  gameCanvas.draw = (ctx) => {
    actor.draw(ctx);
  }

  function fillSelectFromArray(select, array) {
    array.forEach(item => {
      const option = document.createElement('option');
      option.innerText = item;
      select.appendChild(option);
    });
    select.value = array[0];
  }
  
</script>
