<link rel="stylesheet" href="../styles.css">
<script type="module">
  import * as THREE from 'https://unpkg.com/three/build/three.module.js'

  const tileMap = [
    [ 0, 1, 0 ],
    [ 1, 2, 1 ],
    [ 0, 1, 0 ],
  ];

  const cols = tileMap.length, rows = tileMap[0].length;

  
  const scene = new THREE.Scene();
  scene.background = new THREE.Color( 0x222255 );

  const geometry = new THREE.PlaneBufferGeometry( cols, rows, cols, rows );
  geometry.rotateX( -Math.PI / 2 );
  geometry.clearGroups();

  for ( let index = 0, row = 0; row < rows; row ++ ) {
    for ( let col = 0; col < cols; col ++, index += 6 ) {
      geometry.addGroup( index, 6, tileMap[ col ][ row ] );
    }
  }

  const loader = new THREE.TextureLoader();

  const materials = ['grass', 'dirt', 'sand'].map(
    e => new THREE.MeshBasicMaterial({
      map: loader.load(`../textures/${e}.png`, render)
    })
  );

  const mesh = new THREE.Mesh( geometry, materials );
  scene.add( mesh );

  const light = new THREE.DirectionalLight( 0xffffff );
  light.position.set( 0, 1.0, 0.5 );
  light.target.position.set( 0, 0, 0 );
  scene.add( light );

  const camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 );
  camera.position.set( 0, cols * 0.4, cols * 0.8);
  camera.lookAt( 0, 0, 0 );

  const renderer = new THREE.WebGLRenderer();
  renderer.setSize( window.innerWidth, window.innerHeight );
  document.body.appendChild( renderer.domElement );

  function render() {
    renderer.render( scene, camera );
    //requestAnimationFrame( render );
  }
  
  //     window.addEventListener('resize', () => this.resize(), false)

  //     this.renderer.setSize( window.innerWidth, window.innerHeight )
  //     this.camera.aspect = window.innerWidth / window.innerHeight
  //     this.camera.updateProjectionMatrix()
  

</script>