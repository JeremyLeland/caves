<link rel="stylesheet" href="../styles.css">
<script type="module">
  import { Node } from '../build/Pathfinding.js';

  const SIZE = 16;
  const COLS = 100, ROWS = 100;

  const nodesMap = [], nodesList = [];

  for (let index = 0, row = 0; row < ROWS; row ++) {
    for (let col = 0; col < COLS; col ++, index ++) {
      const val = Math.abs( Math.sin( col ) * Math.cos( row ) );

      const node = val < 0.5 ? new Node( col * SIZE + SIZE / 2, row * SIZE + SIZE / 2) : null;

      nodesMap[ index ] = node;

      // null checking is handled by linkNodes()
      if (col > 0)  Node.linkNodes(nodesMap[ index ], nodesMap[ index - 1 ]);
      if (row > 0)  Node.linkNodes(nodesMap[ index ], nodesMap[ index - COLS ]);

      if (node != null) {
        nodesList.push( node );
      }
    }
  }

  const start = nodesList[ 0 ];
  const end = nodesList[ nodesList.length -1 ];

  const timeStr = `Finding path in ${COLS}x${ROWS} grid of nodes`;
  console.time( timeStr );
  const path = Node.A_Star( start, end );
  console.timeEnd( timeStr );

  const canvas = document.createElement( 'canvas' );
  canvas.width = COLS * SIZE;
  canvas.height= ROWS * SIZE;
  const ctx = canvas.getContext('2d');
  
  Node.drawNodes( ctx, nodesList, SIZE / 3 );

  if ( path != null ) {
    Node.drawPath( ctx, path, SIZE / 3 );
  }

  document.body.appendChild( canvas );

</script>